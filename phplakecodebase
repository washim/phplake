#!/bin/bash
ACTION=$1
USER=$2
DEST=$3
SOURCE=$4
FILENAME=$5
TMPFOLDER=$6
WORKSPACE=$7
PROJECT=$8
IDEPASS=$9
IDE=ide-$USER.phplake.com

sudo chown -R phplake:phplake $WORKSPACE
rm -rf $DEST/*
wget $SOURCE -P $WORKSPACE
tar -zxvf $WORKSPACE/$FILENAME -C $WORKSPACE
rm $WORKSPACE/$FILENAME
mv -if $WORKSPACE/$TMPFOLDER/* $DEST
rm -rf $WORKSPACE/$TMPFOLDER
sudo chown -R $USER:$USER $WORKSPACE
if [ $ACTION == "update" ]
then
curl http://$IDE/components/project/controller.php?action=create&project_name=$PROJECT&project_path=$PROJECT&anonymous=yes
elif [ $ACTION == "create" ]
then
curl http://$IDE/components/install/setup.php?path=$DEST&username=$USER&password=$IDEPASS&project_name=$PROJECT&project_path=$PROJECT&timezone=Asia/Kolkata
fi